<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>Kasik</title>	

</head>
<style>
 html,
body {
  width: 100vw;
  height: 100vh;
  margin: 0;
  border: 0;
  padding: 0;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

*,
*::before,
*::after {
  -webkit-box-sizing: inherit;
  -moz-box-sizing: inherit;
  box-sizing: inherit;
}

#app {
  width: 100%;
  height: 97%;
  background: #212121;

  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

.doors {
  display: flex;
}

.door {
  background: #fafafa;
  box-shadow: 0 0 3px 2px rgba(0, 0, 0, 0.4) inset;
  width: 100px;
  height: 150px;
  overflow: hidden;
  border-radius: 1ex;
  margin: 1ch;
}

.boxes {
  transition: transform 1s ease-in-out;
}

.box {
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 3rem;
}

.buttons {
  margin: 1rem 0 2rem 0;
}

button {
  cursor: pointer;
  font-size: 1.2rem;
  text-transform: uppercase;
  margin: 0 0.2rem 0 0.2rem;
}

.info {
  position: fixed;
  bottom: 0;
  width: 100%;
  text-align: center;
}


/* .tern:hover{ */
	/* transform: rotateX(180deg); */
  </style>
<body>		
  <div style="background-color: #212121; color: white; font-size: 100px;text-align: center;" id="OK"></div>
  <div id="many" style=" background-color: #212121; color: white; font-size: 20px;text-align: center;">
    <!--<button onclick="outclik()" style="width: 60px; height: 20px; font-size: 9px; text-align: center;">пополнить</button>-->
    100$
    <!--<button onclick="clik()" style="width: 60px; height: 20px; font-size: 9px; text-align: center;">вывести</button>-->
  </div>
  
  <div id="app">
        <div class="doors">
          <div class="door">
            <div class="boxes">
            </div>
          </div>
      
          <div class="door">
            <div class="boxes">
            </div>
          </div>
      
          <div class="door">
            <div class="boxes">
            </div>
          </div>
          <a href="file:///C://Kasik/Kasik.html" style="margin-left: 1000px; background-color: #212121;text-decoration: none;">➡️</a>
        </div>
        <div class="buttons">
          <button id="minus" onclick="min()">-</button>
          <a id="stavka" style="background-color: #212121; color: white; font-size: 20px;text-align: center;">Ставка 10$</a>
          <button id="plus" onclick="plu()">+</button>
          <button id="spinner">Spin</button>
          <a id="reseter"></a>
          <a id="win" style="background-color: #212121; color: white; font-size: 20px;text-align: center;">Выйгрыш 500$</a>
        </div>
      
        <p class="info"></p>
      </div>
      <script>
        var st=10;
        var w=0;
        var many=100;
        var flag=0;
        function clik(){
          localStorage.setItem('user', many);
          many=0;
          document.getElementById('many').innerHTML='<button onclick="outclik()" style="width: 60px; height: 20px; font-size: 9px; text-align: center;">пополнить</button>'+many+'$<button onclick="clik()" style="width: 60px; height: 20px; font-size: 9px; text-align: center;">вывести</button>';
        }
        function outclik(){
          many=localStorage.getItem('user');
          document.getElementById('many').innerHTML='<button onclick="outclik()" style="width: 60px; height: 20px; font-size: 9px; text-align: center;">пополнить</button>'+many+'$<button onclick="clik()" style="width: 60px; height: 20px; font-size: 9px; text-align: center;">вывести</button>';

        }
        function min(){
          if (st==1)
          {
              alert('сделать ставку меньше нельзя!');
          }
          else
          {
            st--;
            document.getElementById('stavka').innerHTML="Ставка "+st+"$";
            document.getElementById('win').innerHTML='Выйгрыш '+50*st+'$';
          }
        }
        function plu(){
          
            st++;
            document.getElementById('stavka').innerHTML="Ставка "+st+"$";
            document.getElementById('win').innerHTML='Выйгрыш '+50*st+'$';
        }
        (function () {
          "use strict";
  //const items = [
  //  "7️⃣",
  //  "❌",
   // "🍓",
   // "🍋", 
  //  "🍉",
  //  "🍒",
   // "💵",
   // "🍊",
   // "🍎"
  //];
  const items = [
    "7️⃣",
    "❌",
    "🍓",
    "🍋", 
    "🍉",
    "🍒",
    "💵",
    "🍊",
    "🍎",
    "7️⃣",
    "❌",
    "🍓",
    "🍋", 
    "🍉",
    "🍒",
    "💵",
    "🍊",
    "🍎",
    "7️⃣",
    "❌",
    "🍓",
    "🍋", 
    "🍉",
    "🍒",
    "💵",
    "🍊",
    "🍎",
    "7️⃣",
    "❌",
    "🍓",
    "🍋", 
    "🍉",
    "🍒",
    "💵",
    "🍊",
    "🍎",
    "7️⃣",
    "❌",
    "🍓",
    "🍋", 
    "🍉",
    "🍒",
    "💵",
    "🍊",
    "🍎",
    "7️⃣",
    "❌",
    "🍓",
    "🍋", 
    "🍉",
    "🍒",
    "💵",
    "🍊",
    "🍎",
    "7️⃣",
    "❌",
    "🍓",
    "🍋", 
    "🍉",
    "🍒",
    "💵",
    "🍊",
    "🍎",
    "7️⃣",
    "❌",
    "🍓",
    "🍋", 
    "🍉",
    "🍒",
    "💵",
    "🍊",
    "🍎",
    "7️⃣",
    "❌",
    "🍓",
    "🍋", 
    "🍉",
    "🍒",
    "💵",
    "🍊",
    "🍎",
    "7️⃣",
    "❌",
    "🍓",
    "🍋", 
    "🍉",
    "🍒",
    "💵",
    "🍊",
    "🍎"
  ];
  //document.querySelector(".info").textContent = items.join(" ");

  const doors = document.querySelectorAll(".door");
  document.querySelector("#spinner").addEventListener("click", spin);
  document.querySelector("#reseter").addEventListener("click", init);
  async function spin() {
    console.log('flag='+flag);
          if (flag==1)
          {
            alert('You Winn!!!');
            flag=0;
          }
    init(false, 1, 2);
    w++;
    //document.getElementById('OK').innerHTML='п';
    if (many-st<0)
  {
    alert('на болансе не хватает денег!');
    return;
    
  }
    else
    {
      many-=st;
      //document.getElementById('many').innerHTML='<button onclick="outclik()" style="width: 60px; height: 20px; font-size: 9px; text-align: center;">пополнить</button>'+many+'$<button onclick="clik()" style="width: 60px; height: 20px; font-size: 9px; text-align: center;">вывести</button>';
      document.getElementById('many').innerHTML=+many+'$';

    }

      console.log(w);
    for (const door of doors) {
      const boxes = door.querySelector(".boxes");
      const duration = parseInt(boxes.style.transitionDuration);
      boxes.style.transform = "translateY(0)";
      await new Promise((resolve) => setTimeout(resolve, duration * 100));
    }
  }
  function init(firstInit = true, groups = 1, duration = 1) {
    for (const door of doors) {
      if (firstInit) {
        door.dataset.spinned = "0";
      } else if (door.dataset.spinned === "1") {
        //return;
      }

      const boxes = door.querySelector(".boxes");
      const boxesClone = boxes.cloneNode(false);

      const pool = ["❓"];  
      if (!firstInit) {
        const arr = [];
        for (let n = 0; n < (groups > 0 ? groups : 1); n++) {
          arr.push(...items);
        }
        pool.push(...shuffle(arr));

        boxesClone.addEventListener(
          "transitionstart",
          function () {
            door.dataset.spinned = "1";
            this.querySelectorAll(".box").forEach((box) => {
              box.style.filter = "blur(1px)";
            });
          },
          { once: true }
        );

        boxesClone.addEventListener(
          "transitionend",
          function () {
            this.querySelectorAll(".box").forEach((box, index) => {
              box.style.filter = "blur(0)";
              if (index > 0) this.removeChild(box);
            });
          },
          { once: true }
        );
      }
      //var r=0;
      var s;
      for (let i = pool.length - 1; i >= 0; i--) {
        const box = document.createElement("div");
        box.classList.add("box");
        box.style.width = door.clientWidth + "px";
        box.style.height = door.clientHeight + "px";
        box.textContent = pool[i];
        s+=pool[i];
        boxesClone.appendChild(box);
      }
      //if (s[0][0]==s[0][1]) document.getElementById('OK').innerHTML='You Winn!!!';
      boxesClone.style.transitionDuration = `${duration > 0 ? duration : 1}s`;
        boxesClone.style.transform = `translateY(-${
          door.clientHeight * (pool.length - 1)
          }px)`;
          //s+=boxesClone;
          door.replaceChild(boxesClone, boxes);
        }
      }
      var s=[];
  var r=0;
  function shuffle([...arr]) {
    let m = arr.length;
    while (m) {
      const i = Math.floor(Math.random() * m--);
      [arr[m], arr[i]] = [arr[i], arr[m]];
    }
    s[r++]=arr[arr.length-1];
   // if (s[0]==s[1]) document.getElementById('OK').innerHTML='You Winn!!!';
    if (r==3)
    {
      //console.log(s[0]+s[1]+s[2]);
      var f, f1, f2;
      f=s[0];
      f1=s[1];  
      f2=s[2];
      if (f==f1 && f1==f2)
      {
        many+=50*st;
        alert('You Winn!!!');
      } 
        //if (s[0]==s[0]) document.getElementById('OK').innerHTML='You Winn!!!';
        r=0;
    }
    //console.log(s.length+s[1]);
    return arr;
  }
  
  
  init();
})();

      </script>
	
</body>	
</html>